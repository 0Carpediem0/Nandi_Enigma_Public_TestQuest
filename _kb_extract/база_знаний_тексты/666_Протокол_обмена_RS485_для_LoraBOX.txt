Приложение В. Карта Modbus LoraBOX (Версия 1.42.6)

    Пояснения:
r - регистр доступен только для чтения,
w - регистр доступен для чтения и для записи.



 Таблица 1 – Функции 0x04 INPUT
  Адрес    Адрес
                                                                     Тип
 регистра  регистра    Назначение           Примечание         Доступ
                                                                  данных
  (DEC)    (HEX)
 0        0x0000   Заводской номер   Заводской номер LoraBOX    R/-      int32
                   прибора Hi
 1        0x0001   Заводской номер   Заводской номер LoraBOX    R/-
                   прибора Lo
 2        0x0002   DevEui радио-     Для считывания               R/-     Hex
                    модуля. ASCII     необходимо объединить
                    строка [0,1]        значения всех 4 регистров в
                                    одну строку.
                                      Допустим, считанные
                                     значения регистров
                                   следующие:
                                      Регистр 1: 0xCAEF
                                      Регистр 2: 0x2220
                                      Регистр 3: 0x02CD
                                      Регистр 4: 0x0404
                                 Объединяем их, удаляя
                                  префиксы 0x, и получаем
                                     итоговую строку:
                                 «CAEF222002CD0404»





 3        0x0003   DevEui радио-     GWdevEUI_2                  R/-     Hex
                    модуля. ASCII
                    строка [2,3]
 4        0x0004   DevEui радио-     GWdevEUI_3                  R/-     Hex
                    модуля. ASCII
                    строка [4,5]
 5        0x0005   DevEui радио-     GWdevEUI_4                  R/-     Hex
                    модуля. ASCII
                    строка [6,7]
 6        0x0002   Скорость и         9600, 19200, 38400            R/-      int32
                   Сетевой адрес
                 RS485 Hi
 7        0x0003   Скорость и                                          R/-
                   Сетевой адрес
                 RS485 Lo
 8        0x0004   Сетевой адрес     slave_id                        R/-      int16
                  Modbus
9        0x0005   LAN. Сетевой      ip_address_1                  R/-      int16
                    адрес. Первый
                    октет
10       0x0006   LAN. Сетевой      ip_address_2                  R/-      int16
                    адрес. Второй
                    октет
11       0x0007   LAN. Сетевой      ip_address_3                  R/-      int16
                    адрес. Третий
                    октет
12       0x0008   LAN. Сетевой      ip_address_4                  R/-      int16
                    адрес. Четвертый
                    октет
13       0x0009   LAN. Префикс      prefix_mask                    R/-      int16
                    маски.           Расшифровывается по
                                следующей таблице 2
                                   Например, мы получаем
                                  префикс «24» переводим в
                                 Сетевую маску и получаем
                                       «255.255.255.0»
                                  Если же 0, то стоит
                                    проверить подключение
                                           Ethernet.
14       0x000A   Состояние JWT     jwt_state                       R/-      int16
                   токена           0 – неактивен
                                   1 - активен
15       0x000B  Общее            deviceCount                   R/-      int16
                   количество
                   устройств в
                  системе
16       0x000C   Количество        activeDeviceCount             R/-      int16
                   устройств в сети
17       0x000D  Общее            gatewayCount                  R/-      int16
                   количество       Если в 10 (0x000A) регистре
                 модулей gateway   получили 0, то в данном
                                      регистре тоже будет 0.
18       0x000E   Количество        activeGatewayCount           R/-      int16
                   активных         Если в 10 (0x000A) регистре
                 модулей gateway   получили 0, то в данном
                                      регистре тоже будет 0.
19       0x000F   Кол-во             freeSpace                      R/-      uint16
                   свободного       Значение регистра
                   пространства      указывает на объём в
                                    мегабайтах (МБ).
                                  Если получено значение
                                      «8806», это означает, что в
                                      устройстве доступно 8806
                                 МБ.
20       0x0010   Релиз ПО          sw_cert_version                R/-      int16
                                  Каждая цифра значения
                                      регистра отделяется
                                        точкой.
                                   Например:
                                               1. Если получено значение
                                       «20», оно интерпретируется
                                         как «2.0».
                                                2. Если получено значение
                                       «100», оно
                                      интерпретируется как
                                            «1.0.0».
 21       0x0011   Версия прибора    device_build_version           R/-      int16
                                  Каждая цифра значения
                                       регистра отделяется
                                         точкой.
                                    Например:
                                                1. Если получено значение
                                        «20», оно интерпретируется
                                          как «2.0».
                                                2. Если получено значение
                                       «100», оно
                                      интерпретируется как
                                            «1.0.0».
 22       0x0012   Версия             version                         R/-      int16
                  приложения       Значение регистра
                                      интерпретируется
                                следующим образом:
                                                1. Первая цифра –
                                     отдельная часть
                                                2. Следующие две цифры –
                                     вторая часть
                                                3. Оставшиеся цифры –
                                       третья часть
                                  Примеры:
                                                1. Если получено значение
                                       «1418», это
                                      интерпретируется как
                                         «1.41.8»
                                                2. Если получено значение
                                      «14180», это
                                      интерпретируется как
                                        «1.41.80»
 23       0x0013   Напряжение       dev_voltage                    R/-      int16
                   питания внешнее
                  или аккумулятор
                    *100
 24       0x0014   Температура      dev_temp                      R/-      int16
                    внутри корпуса
                    *100
 25       0x0015   Вход 4-20 мА *100  current_input                   R/-      int16
 26       0x0016   Время в LoraBOX  UNIX timestamp                R/-      uint32
                      Hi
 27       0x0017   Время в LoraBOX  UNIX timestamp                R/-
                   Lo

Таблица 2 – prefix_mask
 Сетевая маска   Инверсия       Префикс
 0.0.0.0           255.255.255.255  /0
 128.0.0.0        127.255.255.255  /1
 192.0.0.0         63.255.255.255    /2
 224.0.0.0         31.255.255.255    /3
 240.0.0.0         15.255.255.255    /4
 248.0.0.0         7.255.255.255     /5
 252.0.0.0         3.255.255.255     /6
 254.0.0.0         1.255.255.255     /7
 255.0.0.0         0.255.255.255     /8
 255.128.0.0      0.127.255.255     /9
 255.192.0.0      0.63.255.255      /10
 255.224.0.0      0.31.255.255      /11
 255.240.0.0      0.15.255.255      /12
 255.248.0.0       0.7.255.255       /13
 255.252.0.0       0.3.255.255       /14
 255.254.0.0       0.1.255.255       /15
 255.255.0.0       0.0.255.255       /16
 255.255.128.0    0.0.127.255       /17
 255.255.192.0    0.0.63.255        /18
 255.255.224.0    0.0.31.255        /19
 255.255.240.0    0.0.15.255        /20
 255.255.248.0    0.0.7.255         /21
 255.255.252.0    0.0.3.255         /22
 255.255.254.0    0.0.1.255         /23
 255.255.255.0    0.0.0.255         /24
 255.255.255.128  0.0.0.127         /25
 255.255.255.192  0.0.0.63          /26
 255.255.255.224  0.0.0.31          /27
 255.255.255.240  0.0.0.15          /28
 255.255.255.248  0.0.0.7            /29
 255.255.255.252  0.0.0.3            /30
 255.255.255.254  0.0.0.1            /31
 255.255.255.255  0.0.0.0            /32

Таблица 3 – Функции 0x04 INPUT
                 Данные датчиков.  Примечание           Доступ  Тип данных
                  Размер группы 50
                     регистров.
                   Количество групп
  Адрес    Адрес   80. Начальный
 регистра  регистра  адрес 0-ой
  (DEC)    (HEX)   группы 0x1B58
 7000     0x1B58   ID модуля        Zav_number              R/-        int32, если
                     (заводской        оконечного устройства           устройство
                   номер) Hi        Если устройство              «ROSSMA»,
                           ROSSMA или S-point,             то
                                       то используется 1                используется
                                      буква устройства и его          Hex
                                        mb_id, например
                                  «R001» для ROSSMA и
                                  «S001» для S-point
                                     (отображается в HEX)
7001     0x1B59   ID модуля        Zav_number              R/-
                    (заводской        оконечного устройства
                  номер) Lo
7002     0x1B5A  СЕНСОР_1. Тип   GazName_1              R/-      Hex
                       газа. ASCII
                    строка [0,1]
7003     0x1B5B  СЕНСОР1. Тип    GazName_2              R/-      Hex
                       газа. ASCII
                    строка [2,3]
7004     0x1B5C  СЕНСОР1. Тип    GazName_3              R/-      Hex
                       газа. ASCII
                    строка [4,5]
7005     0x1B5D  СЕНСОР1. Тип    GazName_4              R/-      Hex
                       газа. ASCII
                    строка [6,7]
7006     0x1B5E  СЕНСОР1. Тип    GazName_5              R/-      Hex
                       газа. ASCII
                    строка [8,9]
7007     0x1B5F  СЕНСОР_1.       MeasureUnit_1            R/-        int16
                 Единица
                  измерения
                  0 - "% об.д."
                  1 - "ppm"
                  2 - "ppb"
                  3 - "% НКПР"
                     4-9 - резерв
                  10 - "°С"
7008     0x1B60   СЕНСОР_1. mA   mA_1                     R/-        int16
                   *100
7009     0x1B61   СЕНСОР_1.      Conc_1                   R/-        int16
                  Концентрация /
                  Температура *10
                                    / и т.д
7010     0x1B62   СЕНСОР_2. Тип   GazName_2              R/-      Hex
                       газа. ASCII
                    строка [0,1]
7011     0x1B63   СЕНСОР2. Тип    GazName_3              R/-      Hex
                       газа. ASCII
                    строка [2,3]
7012     0x1B64   СЕНСОР2. Тип    GazName_4              R/-      Hex
                       газа. ASCII
                    строка [6,7]
7013     0x1B65   СЕНСОР2. Тип    GazName_5              R/-      Hex
                       газа. ASCII
                    строка [6,7]
7014     0x1B66   СЕНСОР2. Тип    GazName_6              R/-      Hex
                       газа. ASCII
                    строка [8,9]
7015     0x1B67   СЕНСОР_2.       MeasureUnit_2            R/-        int16
                 Единица
                  измерения
                  0 - "% об.д."
                  1 - "ppm"
                  2 - "ppb"
                  3 - "% НКПР"
                     4-9 - резерв
                  10 - "°С"
7016     0x1B68   СЕНСОР_2. mA   mA_2                     R/-        int16
                   *100
7017     0x1B69   СЕНСОР_2.      Conc_2                   R/-        int16
                  Концентрация /
                  Температура *10
                                    / и т.д
7018     0x1B6A  СЕНСОР3. Тип    GazName_3              R/-      Hex
                       газа. ASCII
                    строка [0,1]
7019     0x1B6B  СЕНСОР3. Тип    GazName_4              R/-      Hex
                       газа. ASCII
                    строка [2,3]
7020     0x1B6C  СЕНСОР3. Тип    GazName_5              R/-      Hex
                       газа. ASCII
                    строка [4,5]
7021     0x1B6D  СЕНСОР3. Тип    GazName_6              R/-      Hex
                       газа. ASCII
                    строка [6,7]
7022     0x1B6E  СЕНСОР3. Тип    GazName_7              R/-      Hex
                       газа. ASCII
                    строка [8,9]
7023     0x1B6F  СЕНСОР_3.       MeasureUnit_3            R/-        int16
                 Единица
                  измерения
                  0 - "% об.д."
                  1 - "ppm"
                  2 - "ppb"
                  3 - "% НКПР"
                     4-9 - резерв
                  10 - "°С"
7024     0x1B70   СЕНСОР_3. mA   mA_3                     R/-        int16
                   *100
7025     0x1B71   СЕНСОР_3.      Conc_3                   R/-        int16
                  Концентрация /
                  Температура *10
                                    / и т.д
7026     0x1B72   СЕНСОР4. Тип    GazName_4              R/-      Hex
                       газа. ASCII
                    строка [0,1]
7027     0x1B73   СЕНСОР4. Тип    GazName_5              R/-      Hex
                       газа. ASCII
                    строка [2,3]
7028     0x1B74   СЕНСОР4. Тип    GazName_6              R/-      Hex
                       газа. ASCII
                    строка [4,5]
7029     0x1B75   СЕНСОР4. Тип    GazName_7              R/-      Hex
                       газа. ASCII
                    строка [6,7]
7030     0x1B76   СЕНСОР4. Тип    GazName_8              R/-      Hex
                       газа. ASCII
                    строка [8,9]
7031     0x1B77   СЕНСОР_4.       MeasureUnit_4            R/-        int16
                 Единица
                  измерения
                  0 - "% об.д."
                  1 - "ppm"
                  2 - "ppb"
                  3 - "% НКПР"
                     4-9 - резерв
                  10 - "°С"
7032     0x1B78   СЕНСОР_4. mA   mA_4                     R/-        int16
                   *100
7033     0x1B79   СЕНСОР_4.      Conc_4                   R/-        int16
                  Концентрация /
                  Температура *10
                                    / и т.д
7034     0x1B7A   Установленный    outCur                    R/-        int16
                  выходной ток *
                  100 мА
7035     0x1B7B  СЕНСОР.        sensTemp                R/-        int16
                  Температура *10
7036     0x1B7C  Общее состояние  devState                  R/-         bits
                   бит 1 - порог 1
                   бит 2 - порог 2
                   бит 3 -
                    отсутствует
                   сенсор либо он
                  повреждён
                   бит 4 - нет связи
                    с сенсором
                   бит 5 -
                 превышение
                   сигнала
                   бит 6 - идёт
                  инициализация
                 модуля
                   бит 7 – режим 0 –
                   рабочий, 1 -
                  сервисный
                   бит 8 -
                   неисправность
                  (проблемы с
                   сенсором)
                   бит 10 - Признак
                  наличия модуля
                   бит 11 -
                  Залипание
                   датчика холла
                   бит 12 - Питание
                    от батарейного
                 модуля
                   бит 13 - Внешнее
                   питание
                   бит 14 - Р Е З Е Р
               В
                   бит 15 - Признак
                  наличия магнита
7037     0x1B7D  СЕНСОР.          sensState                 R/-         bits
                  Состояние
                   бит 0 -
                  Инициализация
                   бит 1 - Рабочий
                   цикл запущен
                   бит 2 - 0 -
                  рабочий режим, 1
                              - сервисный
                   бит 3 - Признак
                  наличия
                   неисправностей
                   бит 4 -
                Превышение
                   сигнала
                   бит 5 - Нет связи
                    с ОУ
                   бит 6 - Нет связи
                    с датчиком
                  температуры
                   бит 7 - Нет связи
                    с АЦП
                   бит 10 - Р Е З Е Р
               В
                   бит 11 - Р Е З Е Р
               В
                   бит 12 - Нет
                  подключенного
                   сенсора либо
                   сенсор
                  повреждён
                   бит 13 -
                Проблемы с
              EEPROM
7038     0x1B7E  СЕНСОР.         sensPercent              R/-        int16
                   Качество связи,
           %
7039     0x1B7F   Заряд батареи, %  batteryPercent            R/-        int16
                   *100
7040     0x1B80   Напряжение на     batteryVolt                R/-        int16
                    батарее, В *100    Пример: в Modbus
                                    значение «2298»,
                                     значит нам
                                  необходимо 2298
                                    разделить на 100
                                   2298 / 100 = 22,98 (В)
7041     0x1B81   Счётчик от        secFromLastCon          R/-        int16
                   последнего
                   сеанса связи, сек
7042     0x1B82   ID последнего     packetNumber            R/-        int32
                   пакета Hi
7043     0x1B83   ID последнего     packetNumber            R/-
                   пакета Lo
7044     0x1B84   Признак наличия  connTimeNow            R/-        int16
                   связи
                   0 - без связи,
                   1 – связь есть,
                   2 – в режиме
                  ожидания
 7045     0x1B85   Уровень сигнала,  connQuality               R/-        int16
               dBm
 7046     0x1B86   Порог 1           porog1                    R/-        int16
 7047     0x1B87   Порог 2           porog2                    R/-        int16

 7048     0x1B88  Р Е З Е Р В       0                          R/-        int16
 7049     0x1B89  Р Е З Е Р В       0                          R/-        int16


     Изменения

Отображение уровня сигнала RSSI теперь ведётся напрямую в dBm (отрицательное
значение), без пересчёта в процентное значение.